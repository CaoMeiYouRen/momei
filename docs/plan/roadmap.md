# 墨梅博客 - 项目计划

本文档展示了项目的发展蓝图。具体的任务执行状态请参阅 [待办事项](./todo.md) 及 [待办归档](./todo-archive.md)。

## 1. 项目概况

**项目名称**: 墨梅(Momei)

**目标**: 构建一个 **AI 驱动、原生国际化** 的开发者博客平台，实现“AI 赋能，全球创作”。

**核心价值主张**:

-   **技术栈**: Nuxt + TypeScript (现代化, SSG/SSR 混合)。
-   **差异化**: 原生国际化 (i18n)、AI 辅助翻译/内容生成、桌面端应用 (Tauri)、平滑迁移支持 (路径别名)。
-   **目标受众**: 开发者、技术作者、跨境创作者。
-   **隐私优先**: 仅在评论和订阅时要求登录，优先支持匿名访问，减少对用户的打扰。

## 2. 开发路线图

### 第一阶段：MVP (最小可行性产品) (已完成)

**时间表**: 约 1.5 个月 (3 名开发人员)

**目标**: 验证核心的内容创作 - 展示 - 基础国际化闭环及迁移能力。专注于业务闭环和低风险技术落地。

#### 核心模块 (P0 - 必须实现)

1.  **内容管理 (精简版)**
    -   **编辑器**: Markdown 支持 (语法高亮、图片拖拽上传)。
    -   **生命周期**: 创建、编辑、删除、草稿 (自动保存)。
    -   **迁移支持**: **路径别名 (自定义 URL Slug)** - 对于迁移用户保留 SEO 至关重要。初期仅支持手动输入，无自动生成逻辑。
    -   **媒体**: 单张图片上传。
    -   **分类**: 基础分类管理。
2.  **用户系统 (精简版)**
    -   **认证**: 邮箱密码与第三方登录 (通过 `Better-Auth`，支持 GitHub、Google 等)。
    -   **登出功能**: 添加登出按钮，支持用户安全退出。
    -   **匿名用户支持**: 默认支持匿名用户浏览内容，无需登录。
    -   **匿名用户管理**: 定义匿名用户的权限和行为规则。
    -   **角色**: 创作者 (管理员) vs. 访客。
    -   **用户管理 (管理员)**: 管理员可查看用户列表、调整用户权限角色、禁用违规账号。
    -   **个人中心**: 我的文章管理、个人资料修改。
3.  **内容展示**
    -   **页面**: 首页 (分页)、文章详情 (目录 TOC)、归档。
    -   **搜索**: 基础关键词搜索 (标题/正文)，使用本地过滤或简单数据库查询。
    -   **响应式**: 使用 SCSS Media Queries 适配 PC 和移动端，保证移动端体验；**优先实现响应式导航（汉堡菜单）**。
    -   **主题**: 支持浅色/深色模式切换及持久化。
    -   **SSR**: 确保核心页面 (首页、文章页) 服务端渲染，利于 SEO。
    -   **阅读量统计 (PV)**: 基础 PV 统计，包含简单的防刷逻辑。
4.  **国际化 (基础)**
    -   **UI**: 中英文切换。
    -   **路由**: `nuxt-i18n` 前缀策略 (`/en/...`)。
    -   **内容**: 手动翻译支持 (AI 集成在后续阶段)。
5.  **安全与配置**
    -   **安全**: 基础 XSS/CSRF 防护，API 的 JWT 认证。
    -   **配置**: 网站名称、Logo、基础 SEO Meta。

### 第二阶段：优化与商业化 (Post-MVP) (已完成)

**时间表**: +1 个月

**目标**: 提升体验，引入变现，并扩大差异化。

1.  **AI 集成**:
    -   AI 标题生成。
    -   AI 摘要自动提取。
    -   AI 智能标签推荐。
    -   AI URL Slug 生成 (基于标题/正文生成简洁、SEO 友好的别名)。
    -   AI 内容翻译 (基于 LLM 的跨语言内容转换，覆盖标题、正文、分类及标签)。
    -   **滥用防护机制**: 考虑到 AI 调用成本，基于“自部署者即信任者”模型，主要实现频率限制与单次任务消耗量监控，防止异常调用及资源浪费。
2.  **订阅体系**:
    -   全局及**多维度 (分类/标签) RSS 订阅源**。
    -   基础邮件通讯 (集成 SendGrid, 全量推送)。
3.  **增强分类体系**:
    -   标签管理。
    -   **标签/分类翻译**。
4.  **国际化深度优化**:
    -   **管理后台实体语言标识**: 扩展文章 (Posts)、分类 (Categories)、标签 (Tags) 及用户 (Users) 的管理页面，增加语言标识显示与筛选支持，确保后台管理体验与前台国际化一致。
    -   **统一翻译管理**: 将同源的多语言实体（文章/分类/标签）在后台管理界面进行聚合展示和管理，解决语言数量增加导致的列表爆炸问题。
5.  **内容体验优化**:
    -   **字数统计与阅读时长**: 自动计算并展示。
    -   **版权声明**: 文章底部自动添加 CC 协议声明 (CC BY-NC-SA 4.0)。
    -   **预览增强**: 增加后台实时预览按钮及前台非发布状态显著提醒。
    -   **高级搜索系统**: 构建多维度过滤 (分类/标签/语言) 的搜索 API，支持多语言同源去重；集成基于数据库索引优化的全文检索方案与 Ctrl+K 快捷键操作。暂时推迟第三方搜索引擎（Algolia/Meilisearch）的集成。
6.  **SEO 增强**:
    -   **站点地图**: 自动生成 `sitemap.xml` (`@nuxtjs/sitemap`)。
    -   Google 网站管理工具验证支持
    -   Bing 网站管理工具验证支持
7.  **外部集成**:
    -   **外部发布 API**: 提供基于 API KEY 的文章发布接口，支持外部系统集成。
8.  **用户体验增强**:
    -   **用户偏好设置**: 支持在用户个人中心设置偏好语言和时区，用于个性化内容展示和邮件通知。
9.  **合规性与法律**:
    -   针对 OAuth 接入要求，提供 **用户协议** 与 **隐私政策** 页面，并在登录/注册页面增加合规勾选。
    -   **备案支持**: 底部增加 **ICP 备案号** 与 **公安备案号** 展示逻辑，支持变量配置。
10. **Demo 模式实现**:
    -   **体验**: 默认使用内存 SQLite 数据库，支持临时体验管理员后台。
    -   **视觉**: 前端增加显著的“演示模式”标识。

### 第三阶段：创新与扩展 (Innovation & Expansion) (已完成)

**时间表**: 待定

**目标**: 建立竞争壁垒并扩展生态系统，实现从“博客程序”到“开发者数字资产中心”的跨越。

1.  **主题与定制化系统 (Theme & Customization System)**:
    -   **引擎重构**: 核心逻辑与 UI 样式解耦，支持第三方主题包加载。
    -   **在线编辑**: 后台集成自定义 CSS/SCSS 变量注入，支持免重启样式调整。
    -   **感官体验**: 实现哀悼模式。
2.  **互动与隐私控制 (Interactions & Privacy Control)**:
    -   **精细化准入**: 支持公开、私密、密码访问、登录可见、订阅可见等 5+ 种可见性策略。
    -   **原生评论**: 内置高性能评论系统，支持点赞、举报及管理员审核。
    -   **反垃圾拦截**: 集成 Cloudflare Turnstile 验证码，在保证极简 UX 的同时拦截自动化脚本。
3.  **内容呈现与质量增强 (Content Rendering & Quality Enhancement)**:
    详细设计请参考: [内容呈现增强设计文档](../design/modules/rendering.md)

    -   **性能优化**: 实现 **Lighthouse 高分优化**，通过预加载、资源压缩等手段提升首屏加载性能。集成 Lighthouse CI。
    -   **语法高亮**: 实现高性能的代码语法高亮（渲染端），面向开发者提升阅读体验。
    -   **图片懒加载**: 实现全站文章图片的原生懒加载，优化首屏加载速度与用户流量消耗。
    -   **Markdown 格式化**: 实现对文章内容的自动化格式化与美化，确保排版规范一致（如 Prettier 集成）。
    -   **自定义容器 (Admonitions)**: 支持 `::: tip` 等容器语法，增强技术文章的重点标注能力。
    -   **代码组 (Code Groups)**: 支持多语言/多方案代码块 Tab 切换展现。
    -   **GitHub 警报**: 兼容 GitHub 风格的标注语法 (`> [!NOTE]`)。
    -   **Emoji 支持**: 增强文字表现力，支持标准 `:emoji:` 语法。
    -   **Lightbox 增强**: 实现点击图片弹出大图预览功能。
4.  **极客体验与自动化部署**:
    -   **零配置启动**: 基于环境变量特征值的自动功能激活与数据库推断，支持本地/容器化部署的“开箱即用”。
5.  **互动、增长与合规 (Interactions, Growth & Compliance)**:
    -   **备案支持**: 底部增加 **ICP 备案号** 与 **公安备案号** 展示逻辑，支持变量配置。
6.  **架构增强与优化 (Architecture & Optimization)**:
    -   **简易部署**: **优化部署文档**，简化 Docker/Vercel 等环境的部署流程，提供极简环境变量配置方案（智能推断、功能自动激活）。
    -   **高性能统计**: 针对高频 PV 统计，实现内存缓冲/批量更新逻辑，降低主表 IO 压力。
    -   **存储进化**: 实现 Local Storage 适配器（带 Serverless 环境卫兵检测）。
7.  **开发者体验与迁移增强 (DevEx & Migration Enhancement)**:
    -   **迁移数据继承**: 在迁移 API 中允许自定义 `createdAt` 和 `views` 等字段，确保 SEO 和历史数据连续性。
    -   **中间件数据传递优化**: 在中间件层级注入共用数据（如 Session/User），减少 API 路由中的重复查询开销。
    -   **AI 驱动开发手册**: 编写现代化的开发文档，指导开发者如何利用 AI (GitHub Copilot/QA Agent) 高效维护和扩展本项目。
8.  **系统固化与极致优化 (System Hardening & Refinement)**:
    -   **动态认证显示**: 自动检测环境变量配置，仅显示已配置 API Key 的第三方登录按钮。
    -   **管理员账号初始化逻辑**: 优化首次部署后的管理员账号确权流程（首选：第一个注册账号自动提权）。
    -   **头像策略优化**: 默认使用 Gravatar 并提供更优雅的兜底策略及缓存。
    -   **Copilot Hooks 集成**: 落地安全/规范拦截、自动 Lint 修复与会话总结记录。

### 第四阶段：专业化与创作进阶 (Professionalization & Creative Empowerment) (已完成)

**时间表**: 约 1 个月

**目标**: 强化专业内容呈现，构建高效 AI 创作辅助流，并提升社区化准入门槛（迁移与投稿）。

1.  **专业内容渲染引擎**:
    -   **数学公式支持**: 原生支持 $LaTeX$ 数学公式渲染 (KaTeX/MathJax)。
### 第五阶段：生态深化与体验极致 (Ecosystem Deepening & Extreme Experience) (策划中)

**时间表**: 待定

**目标**: 探索多媒体内容的深度集成，建立完善的商业化与精准分发机制，并完成全站 AI 创作流的闭环。

1.  **精准推送与多维订阅 (Advanced Subscription)**:
    -   **协议扩展**: 增加对 Atom 1.0 和 JSON Feed 1.1 的原生支持，优化 Feed 中多媒体附件 (Enclosure) 的兼容性。
    -   **精准化控制**: 支持按分类/标签订阅特定内容，并提供日报/周报频率控制。
2.  **商业化集成 (Monetization & Growth)**:
    -   **支付体系**: 集成 Stripe/支付宝支付接口，支持打赏功能或 Pro 会员准入策略。
    -   **私域转化**: 后台可配置公众号关注引导与打赏二维码展示。
3.  **播客与多媒体原生支持 (Podcast & Multimedia)**:
    -   **语音输入增强**: 集成 Whisper 模型进行语音录入，配合 AI 助手实现“语音转博文”或“对话式润色”工作流。
    -   **播客全链路**: 实现音轨上传、元数据自动化与符合播客规范的专项 RSS 输出。
    -   **沉浸式播放**: 全站悬浮播放器，支持跨页面断点续播与内容同步。
4.  **高级 AI 创作流 (Advanced AI Creative Flow)**:
    -   **多模态增强**: 集成 AI 封面图生成 (DALL-E) 与 DeepL 翻译系统。
    -   **灵感重构**: 实现 AI 驱动的灵感片段自动分类、标注与关联知识图谱构建。
5.  **文档全球化与系统化 (Hardening)**:
    -   **国际化固化**: 完成核心部署与开发文档的英文翻译。
    -   **安全校验**: 彻底排查并修复所有页面的权限逻辑漏洞（如敏感设置页）。

## 3. 未来规划与积压项 (Backlog & Long-term Roadmap)

此处记录由于优先级或开发周期原因暂不进入当前迭代，但具有长期价值的功能。

1.  **桌面端应用**: 基于 Tauri 实现离线写作、本地草稿间歇同步与多站点管理。
2.  **极客功能集成**: 支持 Markdown 代码块直接执行；集成基于 Git 的文章版本控制系统。
3.  **主题生态系统 (Theme Ecosystem)**:
    -   **画廊与市场**: 支持保存多套自定义配置，建立主题预览、发布与管理中心。
    -   **安全性与性能**: 实现针对发布主题的自动化 XSS 扫描及 CSS Layer 分层策略。
4.  **其他优化项**: 实现看板娘、背景粒子等可选的视觉增强开关。
## 4. 技术架构与质量保证

### 技术栈

-   **前端/框架**: Nuxt 4 (Vue 3 + TypeScript)。
-   **样式**: SCSS + PrimeVue。
-   **数据库**: SQLite (本地/演示模式) / MySQL / PostgreSQL (生产推荐)。
-   **认证**: Better-Auth (GitHub/Google/Credentials)。
-   **部署**: Vercel / Docker (支持 VPS 手动部署存储)。

### 质量保证策略

1.  **测试**:
    -   **单元测试**: 使用 Vitest 测试核心逻辑 (slug 生成，数据转换)。
    -   **E2E**: 使用 Cypress/Playwright 测试关键路径 (登录 -> 发布)。
    -   **覆盖率目标**: 核心功能 > 80%。
    -   在近期计划中为归档页与移动导航补充测试并纳入 CI。
2.  **性能**:
    -   **SSG/SSR**: 尽可能预渲染静态内容。
    -   **图片优化**: 使用 `<NuxtImg>`。
    -   **监控**: CI/CD 中的 Lighthouse 审计。

### 分析和监控

-   Microsoft Clarity 集成 - 行为分析和会话回放工具集成
-   Sentry 集成 - 错误监控和性能跟踪工具集成
-   百度统计集成 - 网站流量分析和用户行为统计工具集成
-   Google Analytics 集成 - Google Analytics 4 网站分析和用户行为跟踪工具集成

## 4. 市场分析摘要

-   **竞争对手**: WordPress (重型), Hexo/VuePress (静态/无后端), Medium/Dev.to (平台锁定)。
-   **缺口**: 缺乏现代化的、自托管的、国际化优先且 AI 就绪的博客平台。
-   **策略**: 瞄准希望拥有控制权 + 现代化技术栈 + 全球影响力的开发者。

## 5. 相关文档

-   [AI 代理配置](../../AGENTS.md)
-   [待办事项](./todo.md)
-   [开发规范](../standards/development.md)
-   [UI 设计](../design/ui.md)
-   [API 设计](../design/api.md)
-   [测试规范](../standards/testing.md)
