# 墨梅博客 - 项目计划

## 1. 项目概况

**项目名称**: 墨梅(Momei)

**目标**: 构建一个专为技术开发者和跨境内容创作者量身定制的专业、高性能、国际化博客平台。

**核心价值主张**:

-   **技术栈**: Nuxt 3 + TypeScript (现代化, SSG/SSR 混合)。
-   **差异化**: 原生国际化 (i18n)、AI 辅助翻译/内容生成、桌面端应用 (Tauri)、平滑迁移支持 (路径别名)。
-   **目标受众**: 开发者、技术作者、跨境创作者。
-   **隐私优先**: 仅在评论和订阅时要求登录，优先支持匿名访问，减少对用户的打扰。

## 2. 开发路线图

### 第一阶段：MVP (最小可行性产品) (已完成)

**时间表**: 约 1.5 个月 (3 名开发人员)

**目标**: 验证核心的内容创作 - 展示 - 基础国际化闭环及迁移能力。专注于业务闭环和低风险技术落地。

#### 核心模块 (P0 - 必须实现)

1.  **内容管理 (精简版)**
    -   **编辑器**: Markdown 支持 (语法高亮、图片拖拽上传)。
    -   **生命周期**: 创建、编辑、删除、草稿 (自动保存)。
    -   **迁移支持**: **路径别名 (自定义 URL Slug)** - 对于迁移用户保留 SEO 至关重要。初期仅支持手动输入，无自动生成逻辑。
    -   **媒体**: 单张图片上传。
    -   **分类**: 基础分类管理。
2.  **用户系统 (精简版)**
    -   **认证**: 邮箱密码与第三方登录 (通过 `Better-Auth`，支持 GitHub、Google 等)。
    -   **登出功能**: 添加登出按钮，支持用户安全退出。
    -   **匿名用户支持**: 默认支持匿名用户浏览内容，无需登录。
    -   **匿名用户管理**: 定义匿名用户的权限和行为规则。
    -   **角色**: 创作者 (管理员) vs. 访客。
    -   **用户管理 (管理员)**: 管理员可查看用户列表、调整用户权限角色、禁用违规账号。
    -   **个人中心**: 我的文章管理、个人资料修改。
3.  **内容展示**
    -   **页面**: 首页 (分页)、文章详情 (目录 TOC)、归档。
    -   **搜索**: 基础关键词搜索 (标题/正文)，使用本地过滤或简单数据库查询。
    -   **响应式**: 使用 SCSS Media Queries 适配 PC 和移动端，保证移动端体验；**优先实现响应式导航（汉堡菜单）**。
    -   **主题**: 支持浅色/深色模式切换及持久化。
    -   **SSR**: 确保核心页面 (首页、文章页) 服务端渲染，利于 SEO。
    -   **阅读量统计 (PV)**: 基础 PV 统计，包含简单的防刷逻辑。
4.  **国际化 (基础)**
    -   **UI**: 中英文切换。
    -   **路由**: `nuxt-i18n` 前缀策略 (`/en/...`)。
    -   **内容**: 手动翻译支持 (AI 集成在后续阶段)。
5.  **安全与配置**
    -   **安全**: 基础 XSS/CSRF 防护，API 的 JWT 认证。
    -   **配置**: 网站名称、Logo、基础 SEO Meta。

### 第二阶段：优化与商业化 (Post-MVP) (已完成)

**时间表**: +1 个月

**目标**: 提升体验，引入变现，并扩大差异化。

1.  **AI 集成**:
    -   AI 标题生成。
    -   AI 摘要自动提取。
    -   AI 智能标签推荐。
    -   AI URL Slug 生成 (基于标题/正文生成简洁、SEO 友好的别名)。
    -   AI 内容翻译 (基于 LLM 的跨语言内容转换，覆盖标题、正文、分类及标签)。
    -   **滥用防护机制**: 考虑到 AI 调用成本，基于“自部署者即信任者”模型，主要实现频率限制与单次任务消耗量监控，防止异常调用及资源浪费。
2.  **订阅体系**:
    -   全局及**多维度 (分类/标签) RSS 订阅源**。
    -   基础邮件通讯 (集成 SendGrid, 全量推送)。
3.  **增强分类体系**:
    -   标签管理。
    -   **标签/分类翻译**。
4.  **国际化深度优化**:
    -   **管理后台实体语言标识**: 扩展文章 (Posts)、分类 (Categories)、标签 (Tags) 及用户 (Users) 的管理页面，增加语言标识显示与筛选支持，确保后台管理体验与前台国际化一致。
    -   **统一翻译管理**: 将同源的多语言实体（文章/分类/标签）在后台管理界面进行聚合展示和管理，解决语言数量增加导致的列表爆炸问题。
5.  **内容体验优化**:
    -   **字数统计与阅读时长**: 自动计算并展示。
    -   **版权声明**: 文章底部自动添加 CC 协议声明 (CC BY-NC-SA 4.0)。
    -   **预览增强**: 增加后台实时预览按钮及前台非发布状态显著提醒。
    -   **高级搜索系统**: 构建多维度过滤 (分类/标签/语言) 的搜索 API，支持多语言同源去重；集成基于数据库索引优化的全文检索方案与 Ctrl+K 快捷键操作。暂时推迟第三方搜索引擎（Algolia/Meilisearch）的集成。
6.  **SEO 增强**:
    -   **站点地图**: 自动生成 `sitemap.xml` (`@nuxtjs/sitemap`)。
    -   Google 网站管理工具验证支持
    -   Bing 网站管理工具验证支持
7.  **外部集成**:
    -   **外部发布 API**: 提供基于 API KEY 的文章发布接口，支持外部系统集成。
8.  **用户体验增强**:
    -   **用户偏好设置**: 支持在用户个人中心设置偏好语言和时区，用于个性化内容展示和邮件通知。
9.  **合规性与法律**:
    -   针对 OAuth 接入要求，提供 **用户协议** 与 **隐私政策** 页面，并在登录/注册页面增加合规勾选。
10. **Demo 模式实现**:
    -   **安全性**: 实现基于白名单的只读模式，拦截所有修改数据库的操作。
    -   **体验**: 默认使用内存 SQLite 数据库，支持临时体验管理员后台。
    -   **视觉**: 前端增加显著的“演示模式”标识。

### 第三阶段：创新与扩展 (长期) (进行中)

**时间表**: 待定

**目标**: 建立竞争壁垒并扩展生态系统。

1.  **播客与多媒体原生支持 (Podcast & Multimedia)**:
    -   **播客托管**: 支持音轨上传、元数据管理及符合 iTunes 标准的 RSS 订阅源生成。
    -   **音频文章 (Audio Posts)**: 集成 AI TTS 技术，自动为文章生成音频版本，提升无障碍体验及通勤场景下的消费率。
    -   **全站播放器**: 实现无缝切换页面的音频播放体验。
2.  **高级订阅与推送**:
    -   **精准邮件推送**: 支持用户按分类/标签订阅特定内容的邮件提醒。
    -   **推送频率控制**: 支持日报/周报模式。
3.  **用户文档国际化**:
    -   将面向用户的文档 (如“部署指南”、“快速开始”) 翻译为英文。
    -   配置 VitePress 的多语言支持。
4.  **主题引擎与自定义**:
    -   核心逻辑与主题样式解耦，支持多主题切换。
    -   主题插槽 (Slots) 与钩子 (Hooks) 系统。
    -   自定义 CSS/SCSS 变量注入，支持在线样式编辑。
5.  **性能优化与架构增强**:
    -   **性能提升**: 优化集成测试运行速度，提升系统吞吐量。
    -   **本地文件存储支持 (Local Storage)**: 为单机部署用户提供零配置的本地磁盘存储方案，支持自动目录创建与静态资源映射，并具备 Serverless 环境冲突检测。
    -   **商业化**: 集成 Stripe/支付宝；推出 Pro 套餐 (高级 AI 使用限制)。
6.  **互动与社区**:
    -   **文章访问控制**: 支持多样化访问策略 (私密、密码保护、订阅/登录可见等) 与细粒度权限管理。
    -   **社区互动**: 评论系统、点赞。
    -   **投稿流程**: 访客/外部创作者投稿。
7.  **桌面端应用**:
    -   **Tauri 桌面端**: 跨平台离线写作，云端同步。
8.  **高级 AI**:
    -   内容润色与进阶内容优化（自动摘要已在第二阶段实现）。
    -   **专业翻译集成**: 引入 DeepL API 作为高性能协议翻译选项，补充 LLM 翻译在特定术语上的不足。
9.  **AI 封面图生成 (AI Cover Images)**:
    -   **自动绘图**: 集成 DALL-E / Midjourney / Stable Diffusion API，基于文章内容自动生成配套封面图。
    -   **样式定制**: 支持选择极简、扁平化、艺术感等多种视觉风格。
10. **特色功能**:
    -   **哀悼模式**: 在指定的日期全站置灰 (Grayscale)。
    -   **看板娘/粒子效果**: 可选的视觉增强 (Live2D/Particles)。
12. **AI 语音驱动创作 (AI Voice-Driven Creation)**:
    -   **灵感捕捉**: 实现基于 Web Speech API 或高精度 Whisper 模型的语音录入，用于快速记录创作灵感。
    -   **语音转博文 (Voice to Blog)**: 利用 LLM 将碎片化的语音转录文本，自动重构、逻辑润色并生成结构化的 Markdown 博客文章。
    -   **多模态创作协同 (Multi-modal Synergy)**: 将录入的语音、生成的文章与播客系统深度集成，提供“一次语音输入，同步产出博文与播客”的高效创作流。
13. **高级技术**: 代码块执行，基于 Git 的版本控制。

## 3. 技术架构与质量保证

### 技术栈

-   **前端/框架**: Nuxt 3 (Vue 3 + TypeScript)。
-   **样式**: SCSS。
-   **数据库**: PostgreSQL (MVP 推荐使用 Supabase 或类似托管服务)。
-   **认证**: NextAuth.js / NuxtAuth。
-   **部署**: Vercel / Netlify / Docker (注: 暂不支持 Cloudflare Workers，因 TypeORM/Debug 包兼容性问题)。

### 质量保证策略

1.  **测试**:
    -   **单元测试**: 使用 Vitest 测试核心逻辑 (slug 生成，数据转换)。
    -   **E2E**: 使用 Cypress/Playwright 测试关键路径 (登录 -> 发布)。
    -   **覆盖率目标**: 核心功能 > 80%。
    -   在近期计划中为归档页与移动导航补充测试并纳入 CI。
2.  **性能**:
    -   **SSG/SSR**: 尽可能预渲染静态内容。
    -   **图片优化**: 使用 `<NuxtImg>`。
    -   **监控**: CI/CD 中的 Lighthouse 审计。

### 分析和监控

-   Microsoft Clarity 集成 - 行为分析和会话回放工具集成
-   Sentry 集成 - 错误监控和性能跟踪工具集成
-   百度统计集成 - 网站流量分析和用户行为统计工具集成
-   Google Analytics 集成 - Google Analytics 4 网站分析和用户行为跟踪工具集成

## 4. 市场分析摘要

-   **竞争对手**: WordPress (重型), Hexo/VuePress (静态/无后端), Medium/Dev.to (平台锁定)。
-   **缺口**: 缺乏现代化的、自托管的、国际化优先且 AI 就绪的博客平台。
-   **策略**: 瞄准希望拥有控制权 + 现代化技术栈 + 全球影响力的开发者。

## 5. 相关文档

-   [AI 代理配置](../../AGENTS.md)
-   [待办事项](./todo.md)
-   [开发规范](../standards/development.md)
-   [UI 设计](../design/ui.md)
-   [API 设计](../design/api.md)
-   [测试规范](../standards/testing.md)
